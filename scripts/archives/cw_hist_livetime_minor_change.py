import numpy as np
import os, sys
from glob import glob
import h5py
from tqdm import tqdm
from datetime import datetime
from datetime import timezone

curr_path = os.getcwd()
sys.path.append(curr_path+'/../')
from tools.ara_run_manager import file_sorter
from tools.ara_utility import size_checker
from tools.ara_run_manager import run_info_loader

Station = int(sys.argv[1])
if Station == 2:num_configs = 6
if Station == 3:num_configs = 7
num_ants = 16

def cur_cut(Station, g_idx):

    if Station == 2:
            cw_rf_04 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_rf_04[:,0] = np.array([0.07, 0.09, 0.07, 0.07, 0.09, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 1000], dtype = float)
            cw_rf_04[:,1] = np.array([0.07, 0.17, 0.07, 0.07, 0.09, 0.07, 0.07, 0.07, 0.09, 0.13, 0.09, 0.11, 0.11, 0.11, 0.09, 1000], dtype = float)
            cw_rf_04[:,2] = np.array([0.07, 0.09, 0.07, 0.07, 0.09, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 1000], dtype = float)
            cw_rf_04[:,3] = np.array([0.05, 0.07, 0.05, 0.05, 0.07, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 1000], dtype = float)
            cw_rf_04[:,4] = np.array([0.05, 0.05, 0.05, 0.05, 0.07, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 1000], dtype = float)
            cw_rf_04[:,5] = np.array([0.05, 0.05, 0.05, 0.05, 0.07, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 1000], dtype = float)

            cw_rf_025 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_rf_025[:,0] = np.array([0.09, 0.11, 0.09, 0.15, 0.09, 0.09, 0.09, 0.11, 0.11, 0.13, 0.13, 0.25, 0.11, 0.09, 0.11, 1000], dtype = float)
            cw_rf_025[:,1] = np.array([0.11, 0.11, 0.11, 0.13, 0.11, 0.11, 0.25, 0.11, 0.13, 0.13, 0.13, 0.21, 0.11, 0.13, 0.13, 1000], dtype = float)
            cw_rf_025[:,2] = np.array([0.17, 0.17, 0.17, 0.23, 0.15, 0.17, 0.15, 0.15, 0.21, 0.19, 0.19, 0.33, 0.19, 0.17, 0.21, 1000], dtype = float)
            cw_rf_025[:,3] = np.array([0.09, 0.11, 0.09, 0.11, 0.09, 0.09, 0.05, 0.09, 0.13, 0.13, 0.13, 0.29, 0.11, 0.13, 0.13, 1000], dtype = float)
            cw_rf_025[:,4] = np.array([0.09, 0.15, 0.11, 0.13, 0.09, 0.11, 0.17, 0.11, 0.13, 0.15, 0.15, 0.21, 0.11, 0.11, 0.15, 1000], dtype = float)
            cw_rf_025[:,5] = np.array([0.09, 0.11, 0.09, 0.09, 0.09, 0.09, 0.09, 0.09, 0.13, 0.11, 0.11, 0.19, 0.11, 0.11, 0.11, 1000], dtype = float)

            cw_rf_0125 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_rf_0125[:,0] = np.array([0.03, 0.09, 0.03, 0.05, 0.07, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.05, 0.03, 0.03, 1000], dtype = float)
            cw_rf_0125[:,1] = np.array([0.03, 0.07, 0.05, 0.07, 0.23, 0.05, 0.03, 0.05, 0.05, 0.03, 0.03, 0.05, 0.05, 0.07, 0.03, 1000], dtype = float)
            cw_rf_0125[:,2] = np.array([0.05, 0.11, 0.07, 0.09, 0.15, 0.07, 0.07, 0.07, 0.09, 0.05, 0.03, 0.07, 0.07, 0.11, 0.05, 1000], dtype = float)
            cw_rf_0125[:,3] = np.array([0.03, 0.03, 0.03, 0.03, 0.23, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.05, 0.03, 0.05, 0.03, 1000], dtype = float)
            cw_rf_0125[:,4] = np.array([0.03, 0.05, 0.03, 0.03, 0.29, 0.05, 0.03, 0.03, 0.05, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 1000], dtype = float)
            cw_rf_0125[:,5] = np.array([0.03, 0.03, 0.03, 0.03, 0.19, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 1000], dtype = float)

            cw_cal_04 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_cal_04[:,0] = np.array([0.05, 0.05, 0.03, 0.03, 0.05, 0.03, 0.03, 0.03, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 1000], dtype = float)
            cw_cal_04[:,1] = np.array([0.07, 0.09, 0.07, 0.05, 0.07, 0.05, 0.05, 0.07, 0.11, 0.09, 0.07, 0.11, 0.09, 0.09, 0.07, 1000], dtype = float)
            cw_cal_04[:,2] = np.array([0.05, 0.09, 0.03, 0.03, 0.05, 0.05, 0.03, 0.05, 0.07, 0.05, 0.05, 0.05, 0.05, 0.07, 0.05, 1000], dtype = float)
            cw_cal_04[:,3] = np.array([0.05, 0.07, 0.03, 0.03, 0.05, 0.03, 0.03, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 1000], dtype = float)
            cw_cal_04[:,4] = np.array([0.05, 0.07, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 1000], dtype = float)
            cw_cal_04[:,5] = np.array([0.07, 0.05, 0.05, 0.07, 0.07, 0.05, 0.05, 0.07, 0.05, 0.05, 0.05, 0.05, 0.07, 0.05, 0.05, 1000], dtype = float)

            cw_cal_025 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_cal_025[:,0] = np.array([0.07, 0.11, 0.05, 0.09, 0.07, 0.09, 0.07, 0.07, 0.13, 0.13, 0.13, 0.21, 0.13, 0.11, 0.11, 1000], dtype = float)
            cw_cal_025[:,1] = np.array([0.13, 0.15, 0.13, 0.15, 0.13, 0.11, 0.25, 0.11, 0.21, 0.19, 0.19, 0.27, 0.15, 0.17, 0.15, 1000], dtype = float)
            cw_cal_025[:,2] = np.array([0.13, 0.13, 0.07, 0.11, 0.09, 0.09, 0.07, 0.11, 0.15, 0.15, 0.17, 0.21, 0.13, 0.13, 0.15, 1000], dtype = float)
            cw_cal_025[:,3] = np.array([0.07, 0.11, 0.09, 0.11, 0.09, 0.09, 0.09, 0.09, 0.13, 0.15, 0.15, 0.31, 0.15, 0.13, 0.13, 1000], dtype = float)
            cw_cal_025[:,4] = np.array([0.13, 0.13, 0.11, 0.13, 0.11, 0.11, 0.17, 0.11, 0.11, 0.15, 0.13, 0.19, 0.15, 0.15, 0.15, 1000], dtype = float)
            cw_cal_025[:,5] = np.array([0.11, 0.15, 0.11, 0.13, 0.11, 0.09, 0.09, 0.11, 0.17, 0.15, 0.15, 0.23, 0.13, 0.13, 0.15, 1000], dtype = float)

            cw_cal_0125 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_cal_0125[:,0] = np.array([0.03, 0.05, 0.03, 0.05, 0.05, 0.05, 0.03, 0.03, 0.03, 0.03, 0.05, 0.03, 0.03, 0.03, 0.03, 1000], dtype = float)
            cw_cal_0125[:,1] = np.array([0.05, 0.09, 0.05, 0.07, 0.11, 0.05, 0.05, 0.05, 0.07, 0.05, 0.03, 0.07, 0.07, 0.09, 0.05, 1000], dtype = float)
            cw_cal_0125[:,2] = np.array([0.05, 0.05, 0.05, 0.07, 0.07, 0.05, 0.03, 0.05, 0.07, 0.05, 0.03, 0.07, 0.05, 0.09, 0.03, 1000], dtype = float)
            cw_cal_0125[:,3] = np.array([0.05, 0.07, 0.03, 0.03, 0.03, 0.03, 0.03, 0.05, 0.03, 0.05, 0.03, 0.05, 0.05, 0.07, 0.03, 1000], dtype = float)
            cw_cal_0125[:,4] = np.array([0.03, 0.05, 0.05, 0.03, 0.15, 0.03, 0.03, 0.03, 0.05, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 1000], dtype = float)
            cw_cal_0125[:,5] = np.array([0.03, 0.03, 0.05, 0.03, 0.11, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.05, 0.03, 1000], dtype = float)

            cw_soft_04 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_soft_04[:,0] = np.array([0.15, 0.23, 0.15, 0.13, 0.19, 0.15, 0.15, 0.15, 0.19, 0.17, 0.17, 0.21, 0.17, 0.17, 0.17, 1000], dtype = float)
            cw_soft_04[:,1] = np.array([0.17, 0.23, 0.15, 0.13, 0.21, 0.17, 0.15, 0.17, 0.19, 0.21, 0.19, 0.29, 0.21, 0.19, 0.21, 1000], dtype = float)
            cw_soft_04[:,2] = np.array([0.17, 0.23, 0.15, 0.13, 0.21, 0.17, 0.15, 0.17, 0.19, 0.17, 0.21, 0.27, 0.19, 0.17, 0.21, 1000], dtype = float)
            cw_soft_04[:,3] = np.array([0.15, 0.23, 0.15, 0.13, 0.19, 0.15, 0.15, 0.15, 0.19, 0.17, 0.19, 0.17, 0.21, 0.19, 0.19, 1000], dtype = float)
            cw_soft_04[:,4] = np.array([0.15, 0.23, 0.13, 0.13, 0.19, 0.15, 0.15, 0.15, 0.19, 0.17, 0.21, 0.15, 0.19, 0.17, 0.19, 1000], dtype = float)
            cw_soft_04[:,5] = np.array([0.11, 0.11, 0.09, 0.09, 0.13, 0.11, 0.11, 0.11, 0.11, 0.11, 0.11, 0.09, 0.11, 0.11, 0.11, 1000], dtype = float)

            cw_soft_025 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_soft_025[:,0] = np.array([0.25, 0.31, 0.27, 0.35, 0.35, 0.25, 0.21, 0.25, 0.35, 0.39, 0.35, 0.47, 0.29, 0.33, 0.39, 1000], dtype = float)
            cw_soft_025[:,1] = np.array([0.33, 0.37, 0.31, 0.37, 0.37, 0.31, 0.41, 0.31, 0.35, 0.41, 0.35, 0.51, 0.37, 0.39, 0.35, 1000], dtype = float)
            cw_soft_025[:,2] = np.array([0.31, 0.37, 0.31, 0.39, 0.35, 0.31, 0.29, 0.31, 0.37, 0.41, 0.35, 0.47, 0.37, 0.39, 0.35, 1000], dtype = float)
            cw_soft_025[:,3] = np.array([0.29, 0.35, 0.29, 0.31, 0.33, 0.29, 0.35, 0.27, 0.51, 0.41, 0.41, 0.55, 0.37, 0.37, 0.37, 1000], dtype = float)
            cw_soft_025[:,4] = np.array([0.31, 0.35, 0.31, 0.37, 0.37, 0.31, 0.43, 0.33, 0.41, 0.39, 0.37, 0.51, 0.31, 0.33, 0.33, 1000], dtype = float)
            cw_soft_025[:,5] = np.array([0.25, 0.31, 0.23, 0.27, 0.23, 0.23, 0.23, 0.19, 0.45, 0.29, 0.29, 0.43, 0.27, 0.27, 0.27, 1000], dtype = float)

            cw_soft_0125 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_soft_0125[:,0] = np.array([0.05, 0.25, 0.15, 0.19, 0.19, 0.15, 0.15, 0.11, 0.17, 0.13, 0.11, 0.13, 0.13, 0.23, 0.15, 1000], dtype = float)
            cw_soft_0125[:,1] = np.array([0.09, 0.33, 0.17, 0.27, 0.27, 0.13, 0.15, 0.13, 0.21, 0.17, 0.13, 0.17, 0.17, 0.25, 0.21, 1000], dtype = float)
            cw_soft_0125[:,2] = np.array([0.07, 0.31, 0.17, 0.19, 0.27, 0.17, 0.15, 0.13, 0.21, 0.15, 0.11, 0.17, 0.15, 0.27, 0.19, 1000], dtype = float)
            cw_soft_0125[:,3] = np.array([0.05, 0.27, 0.15, 0.17, 0.25, 0.15, 0.13, 0.13, 0.19, 0.15, 0.13, 0.23, 0.13, 0.27, 0.19, 1000], dtype = float)
            cw_soft_0125[:,4] = np.array([0.09, 0.23, 0.13, 0.17, 0.25, 0.15, 0.13, 0.13, 0.21, 0.11, 0.13, 0.17, 0.13, 0.27, 0.19, 1000], dtype = float)
            cw_soft_0125[:,5] = np.array([0.05, 0.07, 0.09, 0.13, 0.15, 0.11, 0.11, 0.09, 0.19, 0.11, 0.07, 0.13, 0.13, 0.17, 0.11, 1000], dtype = float)
    
    if Station == 3:
            cw_rf_04 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_rf_04[:,0] = np.array([0.09, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.05, 0.09, 0.07, 0.07, 0.05, 0.07, 0.09, 0.07, 0.07], dtype = float)
            cw_rf_04[:,1] = np.array([0.11, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.09, 0.07, 0.09, 0.07, 0.07, 0.07, 0.07, 0.07], dtype = float)
            cw_rf_04[:,2] = np.array([0.09, 0.05, 0.07, 1000, 0.05, 0.05, 0.09, 1000, 0.07, 0.07, 0.09, 1000, 0.05, 0.11, 0.13, 1000], dtype = float)
            cw_rf_04[:,3] = np.array([0.07, 0.05, 0.05, 1000, 0.05, 0.05, 0.09, 1000, 0.05, 0.07, 0.11, 1000, 0.05, 0.05, 0.07, 1000], dtype = float)
            cw_rf_04[:,4] = np.array([0.11, 0.07, 0.07, 1000, 0.07, 0.07, 0.09, 1000, 0.09, 0.09, 0.07, 1000, 0.07, 0.11, 0.09, 1000], dtype = float)
            cw_rf_04[:,5] = np.array([0.05, 0.07, 0.11, 0.15, 0.05, 0.05, 0.15, 0.05, 0.05, 0.11, 0.13, 0.15, 0.05, 0.11, 0.13, 0.07], dtype = float)
            cw_rf_04[:,6] = np.array([1000, 0.07, 0.05, 0.15, 1000, 0.05, 0.13, 0.03, 1000, 0.07, 0.13, 0.11, 1000, 0.05, 0.11, 0.07], dtype = float)

            cw_rf_025 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_rf_025[:,0] = np.array([0.15, 0.11, 0.11, 0.11, 0.15, 0.13, 0.15, 0.11, 0.11, 0.11, 0.15, 0.09, 0.15, 0.11, 0.15, 0.11], dtype = float)
            cw_rf_025[:,1] = np.array([0.13, 0.11, 0.11, 0.11, 0.13, 0.13, 0.13, 0.13, 0.15, 0.13, 0.19, 0.13, 0.13, 0.15, 0.15, 0.13], dtype = float)
            cw_rf_025[:,2] = np.array([0.11, 0.07, 0.09, 1000, 0.13, 0.11, 0.09, 1000, 0.13, 0.13, 0.11, 1000, 0.13, 0.13, 0.15, 1000], dtype = float)
            cw_rf_025[:,3] = np.array([0.15, 0.07, 0.13, 1000, 0.15, 0.13, 0.13, 1000, 0.13, 0.17, 0.09, 1000, 0.15, 0.19, 0.19, 1000], dtype = float)
            cw_rf_025[:,4] = np.array([0.15, 0.11, 0.13, 1000, 0.15, 0.15, 0.11, 1000, 0.17, 0.13, 0.15, 1000, 0.15, 0.15, 0.17, 1000], dtype = float)
            cw_rf_025[:,5] = np.array([0.07, 0.13, 0.13, 0.11, 0.11, 0.11, 0.11, 0.11, 0.15, 0.09, 0.09, 0.07, 0.09, 0.13, 0.09, 0.07], dtype = float)
            cw_rf_025[:,6] = np.array([1000, 0.07, 0.11, 0.07, 1000, 0.11, 0.07, 0.09, 1000, 0.11, 0.13, 0.09, 1000, 0.13, 0.15, 0.09], dtype = float)

            cw_rf_0125 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_rf_0125[:,0] = np.array([0.05, 0.03, 0.03, 0.03, 0.03, 0.07, 0.05, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.09, 0.03, 0.03], dtype = float)
            cw_rf_0125[:,1] = np.array([0.05, 0.03, 0.03, 0.03, 0.03, 0.05, 0.05, 0.03, 0.03, 0.05, 0.03, 0.05, 0.05, 0.07, 0.03, 0.03], dtype = float)
            cw_rf_0125[:,2] = np.array([0.03, 0.03, 0.03, 1000, 0.03, 0.05, 0.07, 1000, 0.03, 0.03, 0.03, 1000, 0.03, 0.07, 0.03, 1000], dtype = float)
            cw_rf_0125[:,3] = np.array([0.03, 0.11, 0.11, 1000, 0.03, 0.09, 0.05, 1000, 0.03, 0.09, 0.09, 1000, 0.03, 0.13, 0.11, 1000], dtype = float)
            cw_rf_0125[:,4] = np.array([0.05, 0.03, 0.03, 1000, 0.03, 0.05, 0.05, 1000, 0.05, 0.05, 0.03, 1003, 0.05, 0.07, 0.05, 1000], dtype = float)
            cw_rf_0125[:,5] = np.array([0.03, 0.11, 0.09, 0.03, 0.03, 0.05, 0.05, 0.03, 0.03, 0.07, 0.09, 0.03, 0.03, 0.07, 0.07, 0.03], dtype = float)
            cw_rf_0125[:,6] = np.array([1000, 0.07, 0.03, 0.09, 1000, 0.03, 0.03, 0.15, 1000, 0.03, 0.03, 0.13, 1000, 0.03, 0.03, 0.15], dtype = float)

            cw_cal_04 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_cal_04[:,0] = np.array([0.05, 0.05, 0.07, 0.05, 0.03, 0.03, 0.03, 0.03, 0.09, 0.07, 0.07, 0.07, 0.07, 0.07, 0.07, 0.05], dtype = float)
            cw_cal_04[:,1] = np.array([0.07, 0.11, 0.07, 0.07, 0.07, 0.07, 0.07, 0.05, 0.09, 0.11, 0.09, 0.07, 0.07, 0.11, 0.07, 0.07], dtype = float)
            cw_cal_04[:,2] = np.array([0.05, 0.05, 0.03, 1000, 0.03, 0.03, 0.05, 1000, 0.07, 0.07, 0.07, 1000, 0.05, 0.05, 0.07, 1000], dtype = float)
            cw_cal_04[:,3] = np.array([0.05, 0.05, 0.03, 1000, 0.03, 0.03, 0.05, 1000, 0.05, 0.07, 0.09, 1000, 0.05, 0.05, 0.07, 1000], dtype = float)
            cw_cal_04[:,4] = np.array([0.07, 0.05, 0.07, 1000, 0.03, 0.03, 0.05, 1000, 0.09, 0.09, 0.07, 1000, 0.07, 0.07, 0.07, 1000], dtype = float)
            cw_cal_04[:,5] = np.array([0.05, 0.05, 0.03, 0.13, 0.03, 0.03, 0.13, 0.03, 0.05, 0.07, 0.05, 0.07, 0.05, 0.05, 0.09, 0.05], dtype = float)
            cw_cal_04[:,6] = np.array([1000, 0.05, 0.03, 0.11, 1000, 0.03, 0.11, 0.03, 1000, 0.07, 0.11, 0.11, 1000, 0.05, 0.11, 0.07], dtype = float)

            cw_cal_025 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_cal_025[:,0] = np.array([0.11, 0.09, 0.09, 0.11, 0.07, 0.05, 0.05, 0.05, 0.15, 0.13, 0.17, 0.11, 0.13, 0.11, 0.15, 0.13], dtype = float)
            cw_cal_025[:,1] = np.array([0.15, 0.11, 0.11, 0.11, 0.13, 0.11, 0.13, 0.13, 0.15, 0.17, 0.25, 0.17, 0.17, 0.17, 0.19, 0.15], dtype = float)
            cw_cal_025[:,2] = np.array([0.11, 0.09, 0.09, 1000, 0.09, 0.07, 0.07, 1000, 0.15, 0.13, 0.13, 1000, 0.17, 0.15, 0.17, 1000], dtype = float)
            cw_cal_025[:,3] = np.array([0.11, 0.09, 0.09, 1000, 0.09, 0.09, 0.07, 1000, 0.13, 0.13, 0.15, 1000, 0.15, 0.15, 0.17, 1000], dtype = float)
            cw_cal_025[:,4] = np.array([0.15, 0.09, 0.13, 1000, 0.11, 0.09, 0.07, 1000, 0.19, 0.15, 0.17, 1000, 0.17, 0.19, 0.19, 1000], dtype = float)
            cw_cal_025[:,5] = np.array([0.11, 0.09, 0.11, 0.07, 0.11, 0.11, 0.07, 0.13, 0.15, 0.13, 0.15, 0.17, 0.15, 0.13, 0.15, 0.13], dtype = float)
            cw_cal_025[:,6] = np.array([1000, 0.07, 0.09, 0.05, 1000, 0.09, 0.05, 0.05, 1000, 0.13, 0.13, 0.09, 1000, 0.13, 0.15, 0.09], dtype = float)

            cw_cal_0125 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_cal_0125[:,0] = np.array([0.03, 0.03, 0.07, 0.03, 0.03, 0.03, 0.03, 0.03, 0.05, 0.03, 0.03, 0.03, 0.03, 0.09, 0.03, 0.03], dtype = float)
            cw_cal_0125[:,1] = np.array([0.05, 0.03, 0.07, 0.05, 0.03, 0.05, 0.07, 0.03, 0.05, 0.07, 0.03, 0.07, 0.07, 0.09, 0.05, 0.03], dtype = float)
            cw_cal_0125[:,2] = np.array([0.03, 0.03, 0.03, 1000, 0.03, 0.03, 0.03, 1000, 0.03, 0.05, 0.03, 1000, 0.03, 0.05, 0.03, 1000], dtype = float)
            cw_cal_0125[:,3] = np.array([0.03, 0.03, 0.03, 1000, 0.03, 0.03, 0.03, 1000, 0.03, 0.05, 0.03, 1000, 0.03, 0.07, 0.03, 1000], dtype = float)
            cw_cal_0125[:,4] = np.array([0.05, 0.03, 0.07, 1000, 0.03, 0.03, 0.03, 1000, 0.05, 0.07, 0.03, 1000, 0.07, 0.09, 0.05, 1000], dtype = float)
            cw_cal_0125[:,5] = np.array([0.03, 0.05, 0.05, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.05, 0.05, 0.03, 0.03, 0.05, 0.03, 0.03], dtype = float)
            cw_cal_0125[:,6] = np.array([1000, 0.05, 0.03, 0.13, 1000, 0.05, 0.03, 0.11, 1000, 0.03, 0.03, 0.15, 1000, 0.05, 0.03, 0.17], dtype = float)

            cw_soft_04 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_soft_04[:,0] = np.array([0.21, 0.17, 0.17, 0.15, 0.15, 0.15, 0.15, 0.13, 0.25, 0.19, 0.17, 0.13, 0.17, 0.17, 0.21, 0.15], dtype = float)
            cw_soft_04[:,1] = np.array([0.31, 0.21, 0.19, 0.19, 0.17, 0.17, 0.15, 0.15, 0.21, 0.23, 0.21, 0.15, 0.17, 0.19, 0.17, 0.15], dtype = float)
            cw_soft_04[:,2] = np.array([0.31, 0.19, 0.19, 1000, 0.17, 0.15, 0.17, 1000, 0.21, 0.21, 0.25, 1000, 0.17, 0.19, 0.21, 1000], dtype = float)
            cw_soft_04[:,3] = np.array([0.21, 0.17, 0.17, 1000, 0.15, 0.15, 0.17, 1000, 0.19, 0.21, 0.27, 1000, 0.15, 0.19, 0.21, 1000], dtype = float)
            cw_soft_04[:,4] = np.array([0.29, 0.19, 0.19, 1000, 0.17, 0.17, 0.17, 1000, 0.23, 0.19, 0.19, 1000, 0.17, 0.17, 0.19, 1000], dtype = float)
            cw_soft_04[:,5] = np.array([0.13, 0.13, 0.13, 0.19, 0.11, 0.11, 0.19, 0.11, 0.13, 0.13, 0.15, 0.15, 0.11, 0.15, 0.17, 0.15], dtype = float)
            cw_soft_04[:,6] = np.array([1000, 0.13, 0.11, 0.11, 1000, 0.11, 0.19, 0.07, 1000, 0.15, 0.13, 0.15, 1000, 0.15, 0.21, 0.19], dtype = float)

            cw_soft_025 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_soft_025[:,0] = np.array([0.27, 0.23, 0.21, 0.23, 0.25, 0.23, 0.31, 0.23, 0.35, 0.27, 0.33, 0.21, 0.25, 0.25, 0.31, 0.25], dtype = float)
            cw_soft_025[:,1] = np.array([0.33, 0.29, 0.29, 0.27, 0.35, 0.33, 0.39, 0.35, 0.37, 0.39, 0.47, 0.35, 0.37, 0.39, 0.41, 0.37], dtype = float)
            cw_soft_025[:,2] = np.array([0.37, 0.29, 0.31, 1000, 0.35, 0.31, 0.25, 1000, 0.33, 0.33, 0.31, 1000, 0.39, 0.35, 0.35, 1000], dtype = float)
            cw_soft_025[:,3] = np.array([0.31, 0.19, 0.29, 1000, 0.31, 0.31, 0.25, 1000, 0.35, 0.33, 0.29, 1000, 0.35, 0.33, 0.41, 1000], dtype = float)
            cw_soft_025[:,4] = np.array([0.41, 0.27, 0.29, 1000, 0.35, 0.31, 0.31, 1000, 0.39, 0.31, 0.35, 1000, 0.37, 0.37, 0.41, 1000], dtype = float)
            cw_soft_025[:,5] = np.array([0.23, 0.17, 0.25, 0.15, 0.25, 0.23, 0.17, 0.21, 0.31, 0.23, 0.31, 0.27, 0.29, 0.27, 0.29, 0.23], dtype = float)
            cw_soft_025[:,6] = np.array([1000, 0.13, 0.23, 0.09, 1000, 0.21, 0.15, 0.17, 1000, 0.23, 0.25, 0.19, 1000, 0.27, 0.27, 0.17], dtype = float)

            cw_soft_0125 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_soft_0125[:,0] = np.array([0.11, 0.05, 0.07, 0.09, 0.09, 0.11, 0.15, 0.07, 0.11, 0.11, 0.05, 0.13, 0.11, 0.21, 0.09, 0.05], dtype = float)
            cw_soft_0125[:,1] = np.array([0.17, 0.09, 0.11, 0.11, 0.13, 0.17, 0.15, 0.11, 0.15, 0.15, 0.15, 0.17, 0.19, 0.29, 0.13, 0.11], dtype = float)
            cw_soft_0125[:,2] = np.array([0.13, 0.11, 0.11, 1000, 0.11, 0.17, 0.13, 1000, 0.07, 0.15, 0.13, 1000, 0.15, 0.23, 0.13, 1000], dtype = float)
            cw_soft_0125[:,3] = np.array([0.15, 0.11, 0.11, 1000, 0.11, 0.15, 0.13, 1000, 0.17, 0.15, 0.13, 1000, 0.15, 0.25, 0.13, 1000], dtype = float)
            cw_soft_0125[:,4] = np.array([0.13, 0.11, 0.11, 1000, 0.13, 0.17, 0.15, 1000, 0.15, 0.13, 0.09, 1003, 0.15, 0.21, 0.13, 1000], dtype = float)
            cw_soft_0125[:,5] = np.array([0.07, 0.07, 0.11, 0.05, 0.05, 0.13, 0.09, 0.05, 0.05, 0.09, 0.09, 0.09, 0.07, 0.19, 0.11, 0.03], dtype = float)
            cw_soft_0125[:,6] = np.array([1000, 0.07, 0.13, 0.27, 1000, 0.13, 0.07, 0.35, 1000, 0.07, 0.05, 0.33, 1000, 0.15, 0.09, 0.31], dtype = float)

    cw_rf_04 *= 100
    cw_cal_04 *= 100
    cw_soft_04 *= 100
    cw_rf_025 *= 100
    cw_cal_025 *= 100
    cw_soft_025 *= 100
    cw_rf_0125 *= 100
    cw_cal_0125 *= 100
    cw_soft_0125 *= 100

    cut_04_rf = cw_rf_04[:, g_idx]
    cut_025_rf = cw_rf_025[:, g_idx]
    cut_0125_rf = cw_rf_0125[:, g_idx]
    cut_04_cal = cw_cal_04[:, g_idx]
    cut_025_cal = cw_cal_025[:, g_idx]
    cut_0125_cal = cw_cal_0125[:, g_idx]
    cut_04_soft = cw_soft_04[:, g_idx]
    cut_025_soft = cw_soft_025[:, g_idx]
    cut_0125_soft = cw_soft_0125[:, g_idx]

    return cut_04_rf, cut_025_rf, cut_0125_rf, cut_04_cal, cut_025_cal, cut_0125_cal, cut_04_soft, cut_025_soft, cut_0125_soft

def diff_check(diff_04_rf, cur_04_rf):
        if len(diff_04_rf.shape) != 1:
            temp_arr = np.full(diff_04_rf.shape, np.nan, dtype = float)
            for m in range(diff_04_rf.shape[-1]):
                diff_04_rf_m = diff_04_rf[:, m] - cur_04_rf
                #print(diff_04_rf_m)
                idx_04_rf_m = np.nanargmax(np.where(diff_04_rf_m < 0, diff_04_rf_m, np.nan))
                #print(np.where(diff_04_rf_m < 0, diff_04_rf_m, np.nan))
                #print(idx_04_rf_m)
                temp_arr[idx_04_rf_m, m] = diff_04_rf_m[idx_04_rf_m]
            temp_arr = np.nanmin(temp_arr, axis = 1)
        else:
            temp_arr = np.full(diff_04_rf.shape, np.nan, dtype = float)
            diff_04_rf -= cur_04_rf
            idx_04_rf = np.where(diff_04_rf < 0, diff_04_rf, np.nan).argmax()
            temp_arr[idx_04_rf] = diff_04_rf[idx_04_rf]
        return temp_arr

if Station == 2:
            cw_rf_04 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_rf_04[:,0] = np.array([0.16, 0.12, 0.12, 0.14, 0.18, 0.16, 0.14, 0.18, 0.10, 0.10, 0.10, 0.16, 0.10, 0.12, 0.14, 1000], dtype = float)
            cw_rf_04[:,1] = np.array([0.16, 0.18, 0.16, 0.12, 0.26, 0.18, 0.18, 0.20, 0.16, 0.14, 0.16, 0.18, 0.18, 0.18, 0.16, 1000], dtype = float)
            cw_rf_04[:,2] = np.array([0.14, 0.14, 0.12, 0.12, 0.18, 0.16, 0.14, 0.16, 0.10, 0.10, 0.08, 0.12, 0.12, 0.08, 0.10, 1000], dtype = float)
            cw_rf_04[:,3] = np.array([0.14, 0.12, 0.10, 0.12, 0.16, 0.14, 0.14, 0.16, 0.10, 0.12, 0.10, 0.12, 0.12, 0.10, 0.10, 1000], dtype = float)
            cw_rf_04[:,4] = np.array([0.12, 0.10, 0.10, 0.12, 0.18, 0.12, 0.12, 0.16, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 1000], dtype = float)
            cw_rf_04[:,5] = np.array([0.14, 0.10, 0.12, 0.12, 0.16, 0.14, 0.12, 0.18, 0.10, 0.08, 0.08, 0.10, 0.10, 0.16, 0.08, 1000], dtype = float)

            cw_rf_025 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_rf_025[:,0] = np.array([0.18, 0.20, 0.18, 0.22, 0.18, 0.18, 0.14, 0.16, 0.22, 0.22, 0.24, 0.36, 0.20, 0.22, 0.22, 1000], dtype = float)
            cw_rf_025[:,1] = np.array([0.20, 0.20, 0.18, 0.24, 0.18, 0.16, 0.30, 0.16, 0.24, 0.24, 0.22, 0.34, 0.20, 0.22, 0.22, 1000], dtype = float)
            cw_rf_025[:,2] = np.array([0.18, 0.20, 0.16, 0.24, 0.16, 0.16, 0.14, 0.16, 0.22, 0.22, 0.20, 0.34, 0.20, 0.22, 0.18, 1000], dtype = float)
            cw_rf_025[:,3] = np.array([0.20, 0.20, 0.16, 0.18, 0.14, 0.14, 0.26, 0.16, 0.26, 0.20, 0.18, 0.38, 0.18, 0.22, 0.20, 1000], dtype = float)
            cw_rf_025[:,4] = np.array([0.18, 0.16, 0.16, 0.16, 0.14, 0.16, 0.22, 0.14, 0.24, 0.18, 0.20, 0.30, 0.20, 0.18, 0.16, 1000], dtype = float)
            cw_rf_025[:,5] = np.array([0.18, 0.16, 0.14, 0.16, 0.16, 0.14, 0.14, 0.14, 0.24, 0.20, 0.18, 0.30, 0.18, 0.20, 0.18, 1000], dtype = float)

            cw_rf_0125 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_rf_0125[:,0] = np.array([0.04, 0.14, 0.06, 0.12, 0.14, 0.08, 0.08, 0.10, 0.08, 0.06, 0.04, 0.10, 0.08, 0.18, 0.08, 1000], dtype = float)
            cw_rf_0125[:,1] = np.array([0.04, 0.18, 0.08, 0.14, 0.30, 0.08, 0.08, 0.08, 0.10, 0.08, 0.02, 0.10, 0.06, 0.12, 0.06, 1000], dtype = float)
            cw_rf_0125[:,2] = np.array([0.04, 0.12, 0.06, 0.10, 0.18, 0.08, 0.10, 0.08, 0.08, 0.06, 0.02, 0.08, 0.06, 0.14, 0.06, 1000], dtype = float)
            cw_rf_0125[:,3] = np.array([0.04, 0.10, 0.10, 0.10, 0.36, 0.06, 0.08, 0.08, 0.10, 0.10, 0.04, 0.14, 0.06, 0.08, 0.04, 1000], dtype = float)
            cw_rf_0125[:,4] = np.array([0.04, 0.06, 0.08, 0.06, 0.30, 0.08, 0.04, 0.08, 0.06, 0.04, 0.02, 0.10, 0.06, 0.12, 0.04, 1000], dtype = float)
            cw_rf_0125[:,5] = np.array([0.04, 0.06, 0.10, 0.08, 0.26, 0.06, 0.06, 0.06, 0.10, 0.06, 0.06, 0.12, 0.04, 0.10, 0.08, 1000], dtype = float)

            cw_cal_04 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_cal_04[:,0] = np.array([0.12, 0.08, 0.06, 0.06, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.12, 0.10, 0.08, 0.08, 1000], dtype = float)
            cw_cal_04[:,1] = np.array([0.10, 0.10, 0.10, 0.10, 0.12, 0.12, 0.10, 0.12, 0.10, 0.10, 0.08, 0.16, 0.10, 0.08, 0.08, 1000], dtype = float)
            cw_cal_04[:,2] = np.array([0.10, 0.08, 0.06, 0.06, 0.10, 0.08, 0.06, 0.08, 0.08, 0.06, 0.06, 0.08, 0.10, 0.08, 0.08, 1000], dtype = float)
            cw_cal_04[:,3] = np.array([0.08, 0.08, 0.08, 0.08, 0.12, 0.08, 0.08, 0.10, 0.08, 0.10, 0.08, 0.08, 0.08, 0.08, 0.08, 1000], dtype = float)
            cw_cal_04[:,4] = np.array([0.10, 0.10, 0.10, 0.08, 0.12, 0.08, 0.10, 0.10, 0.06, 0.08, 0.08, 0.08, 0.08, 0.06, 0.08, 1000], dtype = float)
            cw_cal_04[:,5] = np.array([0.10, 0.08, 0.08, 0.10, 0.12, 0.08, 0.08, 0.10, 0.08, 0.06, 0.06, 0.08, 0.08, 0.08, 0.08, 1000], dtype = float)

            cw_cal_025 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_cal_025[:,0] = np.array([0.14, 0.12, 0.08, 0.12, 0.06, 0.10, 0.08, 0.10, 0.18, 0.18, 0.18, 0.26, 0.16, 0.20, 0.18, 1000], dtype = float)
            cw_cal_025[:,1] = np.array([0.16, 0.16, 0.16, 0.18, 0.12, 0.12, 0.26, 0.14, 0.22, 0.18, 0.20, 0.30, 0.18, 0.18, 0.18, 1000], dtype = float)
            cw_cal_025[:,2] = np.array([0.12, 0.12, 0.08, 0.12, 0.08, 0.08, 0.08, 0.10, 0.16, 0.16, 0.16, 0.26, 0.16, 0.16, 0.16, 1000], dtype = float)
            cw_cal_025[:,3] = np.array([0.12, 0.14, 0.12, 0.16, 0.10, 0.10, 0.16, 0.12, 0.20, 0.18, 0.18, 0.34, 0.16, 0.16, 0.16, 1000], dtype = float)
            cw_cal_025[:,4] = np.array([0.14, 0.14, 0.12, 0.16, 0.12, 0.12, 0.20, 0.12, 0.18, 0.20, 0.18, 0.28, 0.16, 0.18, 0.18, 1000], dtype = float)
            cw_cal_025[:,5] = np.array([0.14, 0.14, 0.14, 0.16, 0.12, 0.10, 0.10, 0.14, 0.22, 0.18, 0.16, 0.28, 0.16, 0.18, 0.18, 1000], dtype = float)

            cw_cal_0125 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_cal_0125[:,0] = np.array([0.06, 0.06, 0.04, 0.04, 0.06, 0.04, 0.04, 0.04, 0.06, 0.04, 0.04, 0.08, 0.04, 0.14, 0.04, 1000], dtype = float)
            cw_cal_0125[:,1] = np.array([0.04, 0.10, 0.06, 0.08, 0.10, 0.04, 0.04, 0.04, 0.08, 0.04, 0.02, 0.08, 0.06, 0.10, 0.04, 1000], dtype = float)
            cw_cal_0125[:,2] = np.array([0.06, 0.08, 0.06, 0.08, 0.08, 0.06, 0.04, 0.04, 0.06, 0.04, 0.02, 0.06, 0.06, 0.08, 0.04, 1000], dtype = float)
            cw_cal_0125[:,3] = np.array([0.04, 0.06, 0.04, 0.04, 0.14, 0.04, 0.04, 0.04, 0.04, 0.04, 0.02, 0.06, 0.04, 0.08, 0.04, 1000], dtype = float)
            cw_cal_0125[:,4] = np.array([0.02, 0.04, 0.04, 0.04, 0.16, 0.02, 0.04, 0.04, 0.06, 0.04, 0.02, 0.06, 0.04, 0.08, 0.04, 1000], dtype = float)
            cw_cal_0125[:,5] = np.array([0.04, 0.02, 0.04, 0.04, 0.16, 0.04, 0.04, 0.04, 0.04, 0.06, 0.04, 0.10, 0.04, 0.06, 0.04, 1000], dtype = float)

            cw_soft_04 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_soft_04[:,0] = np.array([0.28, 0.28, 0.24, 0.24, 0.34, 0.28, 0.26, 0.30, 0.22, 0.20, 0.24, 0.28, 0.24, 0.24, 0.26, 1000], dtype = float)
            cw_soft_04[:,1] = np.array([0.28, 0.30, 0.26, 0.22, 0.32, 0.28, 0.26, 0.30, 0.20, 0.22, 0.20, 0.34, 0.22, 0.22, 0.22, 1000], dtype = float)
            cw_soft_04[:,2] = np.array([0.28, 0.28, 0.26, 0.22, 0.32, 0.26, 0.24, 0.28, 0.22, 0.20, 0.22, 0.34, 0.22, 0.20, 0.24, 1000], dtype = float)
            cw_soft_04[:,3] = np.array([0.26, 0.30, 0.26, 0.24, 0.36, 0.28, 0.26, 0.30, 0.24, 0.22, 0.24, 0.26, 0.26, 0.22, 0.24, 1000], dtype = float)
            cw_soft_04[:,4] = np.array([0.28, 0.28, 0.26, 0.24, 0.36, 0.28, 0.28, 0.26, 0.22, 0.22, 0.22, 0.24, 0.24, 0.22, 0.24, 1000], dtype = float)
            cw_soft_04[:,5] = np.array([0.20, 0.18, 0.18, 0.20, 0.28, 0.20, 0.20, 0.22, 0.16, 0.14, 0.16, 0.16, 0.16, 0.18, 0.16, 1000], dtype = float)

            cw_soft_025 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_soft_025[:,0] = np.array([0.36, 0.44, 0.34, 0.42, 0.40, 0.36, 0.32, 0.32, 0.46, 0.44, 0.44, 0.54, 0.36, 0.40, 0.40, 1000], dtype = float)
            cw_soft_025[:,1] = np.array([0.34, 0.44, 0.34, 0.42, 0.38, 0.32, 0.48, 0.34, 0.46, 0.42, 0.40, 0.56, 0.40, 0.42, 0.38, 1000], dtype = float)
            cw_soft_025[:,2] = np.array([0.36, 0.42, 0.32, 0.42, 0.42, 0.34, 0.32, 0.34, 0.42, 0.42, 0.44, 0.54, 0.40, 0.42, 0.40, 1000], dtype = float)
            cw_soft_025[:,3] = np.array([0.38, 0.46, 0.36, 0.44, 0.44, 0.32, 0.46, 0.36, 0.58, 0.44, 0.44, 0.60, 0.40, 0.44, 0.42, 1000], dtype = float)
            cw_soft_025[:,4] = np.array([0.38, 0.40, 0.34, 0.42, 0.38, 0.34, 0.46, 0.36, 0.56, 0.46, 0.42, 0.54, 0.40, 0.42, 0.42, 1000], dtype = float)
            cw_soft_025[:,5] = np.array([0.30, 0.30, 0.26, 0.30, 0.28, 0.26, 0.24, 0.26, 0.54, 0.32, 0.32, 0.48, 0.32, 0.32, 0.30, 1000], dtype = float)

            cw_soft_0125 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_soft_0125[:,0] = np.array([0.12, 0.28, 0.24, 0.28, 0.28, 0.16, 0.20, 0.16, 0.24, 0.18, 0.12, 0.24, 0.18, 0.38, 0.22, 1000], dtype = float)
            cw_soft_0125[:,1] = np.array([0.10, 0.36, 0.20, 0.34, 0.28, 0.14, 0.16, 0.14, 0.26, 0.20, 0.14, 0.22, 0.18, 0.26, 0.24, 1000], dtype = float)
            cw_soft_0125[:,2] = np.array([0.10, 0.36, 0.18, 0.22, 0.26, 0.18, 0.16, 0.14, 0.22, 0.18, 0.14, 0.18, 0.16, 0.30, 0.22, 1000], dtype = float)
            cw_soft_0125[:,3] = np.array([0.14, 0.32, 0.20, 0.22, 0.38, 0.20, 0.16, 0.18, 0.32, 0.20, 0.14, 0.24, 0.18, 0.36, 0.24, 1000], dtype = float)
            cw_soft_0125[:,4] = np.array([0.10, 0.26, 0.18, 0.22, 0.30, 0.18, 0.16, 0.14, 0.28, 0.18, 0.14, 0.22, 0.18, 0.34, 0.24, 1000], dtype = float)
            cw_soft_0125[:,5] = np.array([0.06, 0.08, 0.10, 0.16, 0.24, 0.12, 0.10, 0.10, 0.18, 0.12, 0.04, 0.18, 0.14, 0.20, 0.10, 1000], dtype = float)

if Station == 3:
            cw_rf_04 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_rf_04[:,0] = np.array([0.18, 0.14, 0.12, 0.18, 0.16, 0.12, 0.14, 0.12, 0.12, 0.12, 0.10, 0.12, 0.10, 0.08, 0.12, 0.10], dtype = float)
            cw_rf_04[:,1] = np.array([0.18, 0.16, 0.16, 0.16, 0.16, 0.16, 0.12, 0.14, 0.16, 0.14, 0.16, 0.12, 0.12, 0.10, 0.12, 0.10], dtype = float)
            cw_rf_04[:,2] = np.array([0.18, 0.14, 0.16, 1000, 0.20, 0.14, 0.14, 1000, 0.16, 0.10, 0.14, 1000, 0.10, 0.12, 0.12, 1000], dtype = float)
            cw_rf_04[:,3] = np.array([0.18, 0.14, 0.12, 1000, 0.20, 0.14, 0.12, 1000, 0.16, 0.16, 0.16, 1000, 0.10, 0.14, 0.10, 1000], dtype = float)
            cw_rf_04[:,4] = np.array([0.24, 0.18, 0.16, 1000, 0.22, 0.14, 0.14, 1000, 0.06, 0.14, 0.14, 1000, 0.12, 0.12, 0.12, 1000], dtype = float)
            cw_rf_04[:,5] = np.array([0.16, 0.18, 0.22, 0.18, 0.18, 0.16, 0.22, 0.14, 0.18, 0.16, 0.16, 0.18, 0.14, 0.16, 0.18, 0.14], dtype = float)
            cw_rf_04[:,6] = np.array([1000, 0.16, 0.16, 0.16, 1000, 0.18, 0.20, 0.14, 1000, 0.16, 0.16, 0.14, 1000, 0.12, 0.16, 0.14], dtype = float)

            cw_rf_025 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_rf_025[:,0] = np.array([0.18, 0.16, 0.14, 0.16, 0.20, 0.18, 0.16, 0.18, 0.22, 0.18, 0.20, 0.22, 0.20, 0.22, 0.20, 0.20], dtype = float)
            cw_rf_025[:,1] = np.array([0.20, 0.18, 0.16, 0.16, 0.20, 0.18, 0.20, 0.20, 0.22, 0.20, 0.28, 0.24, 0.22, 0.20, 0.26, 0.22], dtype = float)
            cw_rf_025[:,2] = np.array([0.16, 0.16, 0.18, 1000, 0.18, 0.22, 0.12, 1000, 0.22, 0.18, 0.20, 1000, 0.18, 0.20, 0.24, 1000], dtype = float)
            cw_rf_025[:,3] = np.array([0.20, 0.18, 0.20, 1000, 0.24, 0.22, 0.18, 1000, 0.22, 0.20, 0.24, 1000, 0.26, 0.22, 0.28, 1000], dtype = float)
            cw_rf_025[:,4] = np.array([0.22, 0.20, 0.20, 1000, 0.22, 0.20, 0.16, 1000, 0.22, 0.20, 0.20, 1000, 0.20, 0.24, 0.22, 1000], dtype = float)
            cw_rf_025[:,5] = np.array([0.16, 0.10, 0.16, 0.12, 0.18, 0.16, 0.14, 0.20, 0.20, 0.18, 0.18, 0.18, 0.20, 0.16, 0.18, 0.18], dtype = float)
            cw_rf_025[:,6] = np.array([1000, 0.16, 0.22, 0.10, 1000, 0.22, 0.14, 0.14, 1000, 0.18, 0.20, 0.14, 1000, 0.22, 0.20, 0.16], dtype = float)

            cw_rf_0125 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_rf_0125[:,0] = np.array([0.08, 0.04, 0.06, 0.06, 0.06, 0.08, 0.10, 0.06, 0.04, 0.06, 0.04, 0.08, 0.06, 0.10, 0.06, 0.04], dtype = float)
            cw_rf_0125[:,1] = np.array([0.08, 0.06, 0.06, 0.06, 0.10, 0.08, 0.12, 0.08, 0.06, 0.06, 0.06, 0.08, 0.08, 0.14, 0.08, 0.04], dtype = float)
            cw_rf_0125[:,2] = np.array([0.08, 0.08, 0.10, 1000, 0.06, 0.06, 0.10, 1000, 0.08, 0.10, 0.10, 1000, 0.08, 0.14, 0.10, 1000], dtype = float)
            cw_rf_0125[:,3] = np.array([0.08, 0.08, 0.12, 1000, 0.08, 0.12, 0.12, 1000, 0.10, 0.10, 0.10, 1000, 0.14, 0.14, 0.12, 1000], dtype = float)
            cw_rf_0125[:,4] = np.array([0.08, 0.06, 0.12, 1000, 0.08, 0.08, 0.08, 1000, 0.10, 0.08, 0.06, 1003, 0.10, 0.12, 0.06, 1000], dtype = float)
            cw_rf_0125[:,5] = np.array([0.08, 0.06, 0.10, 0.06, 0.06, 0.10, 0.06, 0.06, 0.08, 0.08, 0.08, 0.10, 0.10, 0.14, 0.08, 0.06], dtype = float)
            cw_rf_0125[:,6] = np.array([1000, 0.10, 0.14, 0.18, 1000, 0.06, 0.04, 0.24, 1000, 0.10, 0.08, 0.26, 1000, 0.10, 0.08, 0.22], dtype = float)

            cw_cal_04 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_cal_04[:,0] = np.array([0.10, 0.06, 0.10, 0.08, 0.04, 0.06, 0.06, 0.06, 0.12, 0.08, 0.10, 0.10, 0.08, 0.08, 0.08, 0.08], dtype = float)
            cw_cal_04[:,1] = np.array([0.12, 0.10, 0.10, 0.10, 0.12, 0.08, 0.10, 0.10, 0.12, 0.08, 0.10, 0.12, 0.08, 0.10, 0.08, 0.08], dtype = float)
            cw_cal_04[:,2] = np.array([0.10, 0.06, 0.06, 1000, 0.06, 0.06, 0.08, 1000, 0.12, 0.08, 0.14, 1000, 0.08, 0.10, 0.06, 1000], dtype = float)
            cw_cal_04[:,3] = np.array([0.10, 0.08, 0.06, 1000, 0.08, 0.08, 0.08, 1000, 0.12, 0.08, 0.16, 1000, 0.08, 0.06, 0.08, 1000], dtype = float)
            cw_cal_04[:,4] = np.array([0.12, 0.06, 0.12, 1000, 0.08, 0.08, 0.06, 1000, 0.14, 0.10, 0.10, 1000, 0.08, 0.08, 0.08, 1000], dtype = float)
            cw_cal_04[:,5] = np.array([0.10, 0.08, 0.10, 0.14, 0.08, 0.06, 0.14, 0.08, 0.14, 0.06, 0.08, 0.08, 0.08, 0.08, 0.12, 0.08], dtype = float)
            cw_cal_04[:,6] = np.array([1000, 0.10, 0.10, 0.10, 1000, 0.08, 0.12, 0.10, 1000, 0.08, 0.10, 0.12, 1000, 0.08, 0.10, 0.06], dtype = float)

            cw_cal_025 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_cal_025[:,0] = np.array([0.16, 0.10, 0.12, 0.12, 0.08, 0.06, 0.06, 0.08, 0.20, 0.18, 0.18, 0.18, 0.20, 0.18, 0.20, 0.18], dtype = float)
            cw_cal_025[:,1] = np.array([0.14, 0.10, 0.12, 0.12, 0.14, 0.14, 0.14, 0.14, 0.20, 0.16, 0.26, 0.20, 0.20, 0.18, 0.20, 0.20], dtype = float)
            cw_cal_025[:,2] = np.array([0.14, 0.12, 0.10, 1000, 0.10, 0.10, 0.08, 1000, 0.18, 0.16, 0.16, 1000, 0.16, 0.18, 0.18, 1000], dtype = float)
            cw_cal_025[:,3] = np.array([0.12, 0.08, 0.10, 1000, 0.10, 0.10, 0.08, 1000, 0.16, 0.14, 0.16, 1000, 0.14, 0.16, 0.18, 1000], dtype = float)
            cw_cal_025[:,4] = np.array([0.16, 0.10, 0.12, 1000, 0.12, 0.10, 0.10, 1000, 0.20, 0.18, 0.20, 1000, 0.20, 0.20, 0.24, 1000], dtype = float)
            cw_cal_025[:,5] = np.array([0.16, 0.10, 0.12, 0.10, 0.12, 0.12, 0.06, 0.12, 0.18, 0.14, 0.14, 0.18, 0.14, 0.18, 0.16, 0.14], dtype = float)
            cw_cal_025[:,6] = np.array([1000, 0.08, 0.12, 0.10, 1000, 0.10, 0.06, 0.12, 1000, 0.14, 0.16, 0.14, 1000, 0.14, 0.16, 0.12], dtype = float)

            cw_cal_0125 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_cal_0125[:,0] = np.array([0.04, 0.02, 0.06, 0.02, 0.02, 0.02, 0.02, 0.02, 0.04, 0.04, 0.02, 0.06, 0.06, 0.08, 0.04, 0.04], dtype = float)
            cw_cal_0125[:,1] = np.array([0.04, 0.04, 0.06, 0.04, 0.02, 0.04, 0.08, 0.04, 0.06, 0.06, 0.04, 0.06, 0.06, 0.10, 0.04, 0.04], dtype = float)
            cw_cal_0125[:,2] = np.array([0.02, 0.02, 0.04, 1000, 0.02, 0.04, 0.02, 1000, 0.04, 0.04, 0.02, 1000, 0.06, 0.06, 0.02, 1000], dtype = float)
            cw_cal_0125[:,3] = np.array([0.04, 0.02, 0.02, 1000, 0.02, 0.02, 0.06, 1000, 0.04, 0.04, 0.04, 1000, 0.10, 0.06, 0.02, 1000], dtype = float)
            cw_cal_0125[:,4] = np.array([0.04, 0.02, 0.08, 1000, 0.02, 0.04, 0.06, 1000, 0.06, 0.06, 0.04, 1000, 0.10, 0.08, 0.04, 1000], dtype = float)
            cw_cal_0125[:,5] = np.array([0.04, 0.02, 0.04, 0.02, 0.04, 0.04, 0.02, 0.02, 0.04, 0.02, 0.02, 0.04, 0.08, 0.04, 0.04, 0.04], dtype = float)
            cw_cal_0125[:,6] = np.array([1000, 0.02, 0.02, 0.12, 1000, 0.06, 0.02, 0.16, 1000, 0.04, 0.02, 0.20, 1000, 0.08, 0.04, 0.18], dtype = float)

            cw_soft_04 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_soft_04[:,0] = np.array([0.34, 0.26, 0.26, 0.26, 0.26, 0.24, 0.26, 0.20, 0.26, 0.22, 0.20, 0.22, 0.22, 0.20, 0.28, 0.20], dtype = float)
            cw_soft_04[:,1] = np.array([0.36, 0.26, 0.26, 0.26, 0.28, 0.24, 0.24, 0.24, 0.26, 0.24, 0.24, 0.22, 0.20, 0.22, 0.22, 0.22], dtype = float)
            cw_soft_04[:,2] = np.array([0.40, 0.28, 0.26, 1000, 0.34, 0.24, 0.26, 1000, 0.30, 0.24, 0.28, 1000, 0.20, 0.24, 0.30, 1000], dtype = float)
            cw_soft_04[:,3] = np.array([0.32, 0.26, 0.26, 1000, 0.26, 0.26, 0.26, 1000, 0.28, 0.22, 0.32, 1000, 0.20, 0.24, 0.24, 1000], dtype = float)
            cw_soft_04[:,4] = np.array([0.38, 0.26, 0.26, 1000, 0.30, 0.22, 0.24, 1000, 0.26, 0.22, 0.22, 1000, 0.22, 0.20, 0.22, 1000], dtype = float)
            cw_soft_04[:,5] = np.array([0.22, 0.16, 0.18, 0.20, 0.22, 0.16, 0.24, 0.20, 0.26, 0.14, 0.16, 0.18, 0.16, 0.16, 0.24, 0.16], dtype = float)
            cw_soft_04[:,6] = np.array([1000, 0.16, 0.18, 0.14, 1000, 0.24, 0.24, 0.14, 1000, 0.14, 0.18, 0.14, 1000, 0.16, 0.24, 0.18], dtype = float)

            cw_soft_025 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_soft_025[:,0] = np.array([0.36, 0.28, 0.32, 0.30, 0.40, 0.36, 0.32, 0.40, 0.40, 0.34, 0.40, 0.38, 0.40, 0.40, 0.40, 0.38], dtype = float)
            cw_soft_025[:,1] = np.array([0.38, 0.30, 0.32, 0.34, 0.38, 0.36, 0.42, 0.38, 0.44, 0.40, 0.48, 0.38, 0.42, 0.38, 0.46, 0.42], dtype = float)
            cw_soft_025[:,2] = np.array([0.40, 0.34, 0.36, 1000, 0.40, 0.36, 0.30, 1000, 0.42, 0.36, 0.40, 1000, 0.40, 0.42, 0.48, 1000], dtype = float)
            cw_soft_025[:,3] = np.array([0.38, 0.30, 0.36, 1000, 0.42, 0.38, 0.30, 1000, 0.42, 0.36, 0.40, 1000, 0.40, 0.42, 0.46, 1000], dtype = float)
            cw_soft_025[:,4] = np.array([0.42, 0.32, 0.34, 1000, 0.38, 0.36, 0.32, 1000, 0.44, 0.38, 0.40, 1000, 0.40, 0.38, 0.46, 1000], dtype = float)
            cw_soft_025[:,5] = np.array([0.26, 0.20, 0.26, 0.16, 0.28, 0.28, 0.18, 0.26, 0.32, 0.28, 0.30, 0.28, 0.34, 0.32, 0.36, 0.28], dtype = float)
            cw_soft_025[:,6] = np.array([1000, 0.18, 0.28, 0.14, 1000, 0.26, 0.18, 0.26, 1000, 0.28, 0.30, 0.22, 1000, 0.32, 0.30, 0.22], dtype = float)

            cw_soft_0125 = np.full((num_ants, num_configs), np.nan, dtype = float)
            cw_soft_0125[:,0] = np.array([0.14, 0.10, 0.12, 0.12, 0.12, 0.18, 0.16, 0.12, 0.16, 0.14, 0.12, 0.16, 0.16, 0.22, 0.16, 0.10], dtype = float)
            cw_soft_0125[:,1] = np.array([0.20, 0.12, 0.12, 0.12, 0.16, 0.20, 0.22, 0.12, 0.18, 0.16, 0.16, 0.18, 0.18, 0.32, 0.14, 0.12], dtype = float)
            cw_soft_0125[:,2] = np.array([0.22, 0.14, 0.12, 1000, 0.14, 0.18, 0.18, 1000, 0.24, 0.16, 0.14, 1000, 0.20, 0.28, 0.16, 1000], dtype = float)
            cw_soft_0125[:,3] = np.array([0.18, 0.10, 0.10, 1000, 0.16, 0.18, 0.14, 1000, 0.24, 0.16, 0.14, 1000, 0.18, 0.30, 0.16, 1000], dtype = float)
            cw_soft_0125[:,4] = np.array([0.14, 0.12, 0.12, 1000, 0.12, 0.18, 0.16, 1000, 0.18, 0.16, 0.16, 1003, 0.18, 0.24, 0.16, 1000], dtype = float)
            cw_soft_0125[:,5] = np.array([0.10, 0.08, 0.14, 0.10, 0.10, 0.12, 0.10, 0.08, 0.14, 0.10, 0.08, 0.14, 0.16, 0.20, 0.10, 0.08], dtype = float)
            cw_soft_0125[:,6] = np.array([1000, 0.08, 0.14, 0.30, 1000, 0.12, 0.06, 0.40, 1000, 0.10, 0.06, 0.28, 1000, 0.16, 0.10, 0.36], dtype = float)

cw_rf_04 *= 100
cw_cal_04 *= 100
cw_soft_04 *= 100
cw_rf_025 *= 100
cw_cal_025 *= 100
cw_soft_025 *= 100
cw_rf_0125 *= 100
cw_cal_0125 *= 100
cw_soft_0125 *= 100

blined = ''
blined = '_full'

# sort
d_path = os.path.expandvars("$OUTPUT_PATH") + f'/OMF_filter/ARA0{Station}/cw_val{blined}/*'
d_list, d_run_tot, d_run_range = file_sorter(d_path)
del d_path, d_run_range
r_path = os.path.expandvars("$OUTPUT_PATH") + f'/OMF_filter/ARA0{Station}/cw_cut{blined}/'

out_04_rf = np.full((num_ants, len(d_run_tot)), np.nan, dtype = float)
out_025_rf = np.full((num_ants, len(d_run_tot)), np.nan, dtype = float)
out_0125_rf = np.full((num_ants, len(d_run_tot)), np.nan, dtype = float)
out_04_cal = np.full((num_ants, len(d_run_tot)), np.nan, dtype = float)
out_025_cal = np.full((num_ants, len(d_run_tot)), np.nan, dtype = float)
out_0125_cal = np.full((num_ants, len(d_run_tot)), np.nan, dtype = float)
out_04_soft = np.full((num_ants, len(d_run_tot)), np.nan, dtype = float)
out_025_soft = np.full((num_ants, len(d_run_tot)), np.nan, dtype = float)
out_0125_soft = np.full((num_ants, len(d_run_tot)), np.nan, dtype = float)

config = []

for r in tqdm(range(len(d_run_tot))):
  #if r == 0:   
  #if r == 418:   
 
    ara_run = run_info_loader(Station, d_run_tot[r])
    g_idx = ara_run.get_config_number() - 1
    del ara_run
    config.append(g_idx+1)

    cur_04_rf, cur_025_rf, cur_0125_rf, cur_04_cal, cur_025_cal, cur_0125_cal, cur_04_soft, cur_025_soft, cur_0125_soft = cur_cut(Station, g_idx)

    cut_04_rf = cw_rf_04[:, g_idx]
    cut_025_rf = cw_rf_025[:, g_idx]
    cut_0125_rf = cw_rf_0125[:, g_idx]
    cut_04_cal = cw_cal_04[:, g_idx]
    cut_025_cal = cw_cal_025[:, g_idx]
    cut_0125_cal = cw_cal_0125[:, g_idx]
    cut_04_soft = cw_soft_04[:, g_idx]
    cut_025_soft = cw_soft_025[:, g_idx]
    cut_0125_soft = cw_soft_0125[:, g_idx]

    cut_name = f'{r_path}cw_cut{blined}_A{Station}_R{d_run_tot[r]}.h5'
    hf_c = h5py.File(cut_name, 'r')
    trig_type = hf_c['trig_type'][:]
    cw_qual_cut = hf_c['cw_qual_cut'][:]
    cw_qual_cut = cw_qual_cut != 0 
    del cut_name, hf_c

    hf = h5py.File(d_list[r], 'r')
    sub_r = hf['sub_ratios'][:] * 100   
    sub_04_rf = np.copy(sub_r[2])
    sub_025_rf = np.copy(sub_r[1])
    sub_0125_rf = np.copy(sub_r[0])
    sub_04_cal = np.copy(sub_r[2])
    sub_025_cal = np.copy(sub_r[1])
    sub_0125_cal = np.copy(sub_r[0])
    sub_04_soft = np.copy(sub_r[2])
    sub_025_soft = np.copy(sub_r[1])
    sub_0125_soft = np.copy(sub_r[0])
    sub_04_rf[:, np.logical_or(cw_qual_cut[:,0], trig_type != 0)] = np.nan
    sub_025_rf[:, np.logical_or(cw_qual_cut[:,1], trig_type != 0)] = np.nan
    sub_0125_rf[:, np.logical_or(cw_qual_cut[:,1], trig_type != 0)] = np.nan
    sub_04_cal[:, np.logical_or(cw_qual_cut[:,0], trig_type != 1)] = np.nan
    sub_025_cal[:, np.logical_or(cw_qual_cut[:,1], trig_type != 1)] = np.nan
    sub_0125_cal[:, np.logical_or(cw_qual_cut[:,1], trig_type != 1)] = np.nan
    sub_04_soft[:, np.logical_or(cw_qual_cut[:,0], trig_type != 2)] = np.nan
    sub_025_soft[:, np.logical_or(cw_qual_cut[:,1], trig_type != 2)] = np.nan
    sub_0125_soft[:, np.logical_or(cw_qual_cut[:,1], trig_type != 2)] = np.nan
    del hf, sub_r, trig_type, cw_qual_cut

    rf_04 = np.any(sub_04_rf > cut_04_rf[:, np.newaxis], axis = 0)
    rf_025 = np.any(sub_025_rf > cut_025_rf[:, np.newaxis], axis = 0)
    rf_0125 = np.any(sub_0125_rf > cut_0125_rf[:, np.newaxis], axis = 0)
    if np.any(rf_04):
        #print(f'rf 04, C{g_idx+1} A{Station} Run{d_run_tot[r]}')
        #print(cut_04_rf.astype(int))
        #print(sub_04_rf[:, rf_04].T)
        #print(sub_04_rf[:, rf_04].shape)
        #print(len(sub_04_rf[:, rf_04].shape))
        #print(cur_04_rf.astype(int))
        #print(sub_04_rf[:, rf_04][:,0] - cur_04_rf)
        diff_04_rf = sub_04_rf[:, rf_04]
        out_04_rf[:,r] = diff_check(diff_04_rf, cur_04_rf)
        #print(out_04_rf[:,r])
    if np.any(rf_025):
        #print(f'rf 025, C{g_idx+1} A{Station} Run{d_run_tot[r]}')
        #print(cut_025_rf.astype(int))
        #print(sub_025_rf[:, rf_025].T)
        #print(sub_025_rf[:, rf_025].shape)
        diff_025_rf = sub_025_rf[:, rf_025]
        out_025_rf[:,r] = diff_check(diff_025_rf, cur_025_rf)
    if np.any(rf_0125):
        #print(f'rf 0125, C{g_idx+1} A{Station} Run{d_run_tot[r]}')
        #print(cut_0125_rf.astype(int))
        #print(sub_0125_rf[:, rf_0125].T)
        #print(sub_0125_rf[:, rf_0125].shape)
        diff_0125_rf = sub_0125_rf[:, rf_0125]
        out_0125_rf[:,r] = diff_check(diff_0125_rf, cur_0125_rf)
    cal_04 = np.any(sub_04_cal > cut_04_cal[:, np.newaxis], axis = 0)
    cal_025 = np.any(sub_025_cal > cut_025_cal[:, np.newaxis], axis = 0)
    cal_0125 = np.any(sub_0125_cal > cut_0125_cal[:, np.newaxis], axis = 0)
    if np.any(cal_04):
        #print(f'cal 04, C{g_idx+1} A{Station} Run{d_run_tot[r]}')
        #print(sub_04_cal[:, cal_04])
        #print(sub_04_cal[:, cal_04].shape)
        diff_04_cal = sub_04_cal[:, cal_04]
        out_04_cal[:,r] = diff_check(diff_04_cal, cur_04_cal)
    if np.any(cal_025):
        #print(f'cal 025, C{g_idx+1} A{Station} Run{d_run_tot[r]}')
        #print(sub_025_cal[:, cal_025])
        #print(sub_025_cal[:, cal_025].shape)
        diff_025_cal = sub_025_cal[:, cal_025]
        out_025_cal[:,r] = diff_check(diff_025_cal, cur_025_cal)
    if np.any(cal_0125):
        #print(f'cal 0125, C{g_idx+1} A{Station} Run{d_run_tot[r]}')
        #print(sub_0125_cal[:, cal_0125])
        #print(sub_0125_cal[:, cal_0125].shape)
        diff_0125_cal = sub_0125_cal[:, cal_0125]
        out_0125_cal[:,r] = diff_check(diff_0125_cal, cur_0125_cal)
    soft_04 = np.any(sub_04_soft > cut_04_soft[:, np.newaxis], axis = 0)
    soft_025 = np.any(sub_025_soft > cut_025_soft[:, np.newaxis], axis = 0)
    soft_0125 = np.any(sub_0125_soft > cut_0125_soft[:, np.newaxis], axis = 0)
    if np.any(soft_04):
        #print(f'soft 04, C{g_idx+1} A{Station} Run{d_run_tot[r]}')
        #print(sub_04_soft[:, soft_04])
        #print(sub_04_soft[:, soft_04].shape)
        diff_04_soft = sub_04_soft[:, soft_04]
        out_04_soft[:,r] = diff_check(diff_04_soft, cur_04_soft)
    if np.any(soft_025):
        #print(f'soft 025, C{g_idx+1} A{Station} Run{d_run_tot[r]}')
        #print(sub_025_soft[:, soft_025])
        #print(sub_025_soft[:, soft_025].shape)
        diff_025_soft = sub_025_soft[:, soft_025]
        out_025_soft[:,r] = diff_check(diff_025_soft, cur_025_soft)
    if np.any(soft_0125):
        #print(f'soft 0125, C{g_idx+1} A{Station} Run{d_run_tot[r]}')
        #print(sub_0125_soft[:, soft_0125])
        #print(sub_0125_soft[:, soft_0125].shape)
        diff_0125_soft = sub_0125_soft[:, soft_0125]
        out_0125_soft[:,r] = diff_check(diff_0125_soft, cur_0125_soft)
    del sub_04_rf, sub_025_rf, sub_0125_rf, sub_04_cal, sub_025_cal, sub_0125_cal, sub_04_soft, sub_025_soft, sub_0125_soft
    del rf_04, rf_025, rf_0125, cal_04, cal_025, cal_0125, soft_04, soft_025, soft_0125
    del g_idx
    
path = os.path.expandvars("$OUTPUT_PATH") + f'/OMF_filter/ARA0{Station}/Hist/'
if not os.path.exists(path):
    os.makedirs(path)
os.chdir(path)
file_name = f'CW_Table_Minor_Change{blined}_v4_A{Station}.h5'
hf = h5py.File(file_name, 'w')
hf.create_dataset('config', data=np.asarray(config), compression="gzip", compression_opts=9)
hf.create_dataset('run_num', data=d_run_tot, compression="gzip", compression_opts=9)
hf.create_dataset('out_04_rf', data=out_04_rf, compression="gzip", compression_opts=9)
hf.create_dataset('out_025_rf', data=out_025_rf, compression="gzip", compression_opts=9)
hf.create_dataset('out_0125_rf', data=out_0125_rf, compression="gzip", compression_opts=9)
hf.create_dataset('out_04_cal', data=out_04_cal, compression="gzip", compression_opts=9)
hf.create_dataset('out_025_cal', data=out_025_cal, compression="gzip", compression_opts=9)
hf.create_dataset('out_0125_cal', data=out_0125_cal, compression="gzip", compression_opts=9)
hf.create_dataset('out_04_soft', data=out_04_soft, compression="gzip", compression_opts=9)
hf.create_dataset('out_025_soft', data=out_025_soft, compression="gzip", compression_opts=9)
hf.create_dataset('out_0125_soft', data=out_0125_soft, compression="gzip", compression_opts=9)
hf.close()

print('file is in:',path+file_name)
# quick size check
size_checker(path+file_name)
print('done!')






